<div class="sticky top-28 space-y-6">
  <!-- Cart Card -->
  <div class="bg-[#1a2e22] rounded-3xl p-6 border border-[#28392f] shadow-2xl">
    <h3 class="text-xl font-bold text-white mb-6 pb-4 border-b border-[#28392f]">Récapitulatif de commande</h3>
    
    <!-- Items List -->
    <div class="flex flex-col gap-4 max-h-[340px] overflow-y-auto pr-2 custom-scrollbar mb-6">
      <div *ngFor="let item of cartItems()" class="flex gap-4 items-start">
        <div class="relative w-20 h-20 rounded-xl overflow-hidden bg-white/5 flex-shrink-0 border border-[#28392f]">
          <div class="w-full h-full bg-cover bg-center opacity-90" [style.backgroundImage]="'url(' + item.image + ')'"></div>
          <span class="absolute bottom-1 right-1 bg-background-dark/80 text-white text-[10px] font-bold px-1.5 py-0.5 rounded backdrop-blur-sm">x{{item.quantity}}</span>
        </div>
        <div class="flex flex-col flex-1">
          <h4 class="text-white font-medium text-sm leading-tight line-clamp-2">{{item.name}}</h4>
          <span class="text-[#9db9a8] text-xs mt-1">Ref: {{item.ref}}</span>
          <p class="text-primary font-bold mt-2">{{getConvertedItemTotal(item)}}</p>
        </div>
      </div>
    </div>

    <!-- Discount Code -->
    <div class="mb-6">
      <div class="flex gap-2">
        <input class="flex-1 bg-[#111814] border border-[#28392f] rounded-xl px-4 py-2 text-sm text-white placeholder-[#5a7a68] focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary" placeholder="Code promo" type="text"/>
        <button class="bg-[#28392f] hover:bg-[#3a5c1a] text-white px-4 py-2 rounded-xl text-sm font-medium transition-colors">Appliquer</button>
      </div>
    </div>

    <!-- Totals -->
    <div class="space-y-3 pt-4 border-t border-[#28392f] text-sm">
      <div class="flex justify-between text-[#9db9a8]">
        <span>Sous-total HT</span>
        <span>{{convertedSubtotal()}}</span>
      </div>
      <div class="flex justify-between text-[#9db9a8]">
        <span>TVA (20%)</span>
        <span>{{convertedTax()}}</span>
      </div>
      <div class="flex justify-between text-[#9db9a8]">
        <span>Livraison (Standard)</span>
        <span class="text-primary">Gratuit</span>
      </div>
      <div class="flex justify-between items-center pt-4 mt-2 border-t border-[#28392f]">
        <span class="text-white font-bold text-lg">Total TTC</span>
        <div class="text-right">
          <span class="block text-2xl font-black text-white">{{convertedTotal()}}</span>
          <span class="text-[10px] text-[#9db9a8]">TVA incluse</span>
        </div>
      </div>
    </div>

    <!-- Primary Action Desktop -->
    <button (click)="action.emit()" class="hidden lg:flex w-full mt-8 h-14 bg-primary hover:bg-[#0fd65f] text-background-dark text-lg font-bold rounded-full items-center justify-center gap-2 transition-all shadow-[0_0_20px_rgba(19,236,106,0.2)] hover:shadow-[0_0_30px_rgba(19,236,106,0.4)] hover:scale-[1.02]">
      <span>{{ actionLabel }}</span>
      <span class="material-symbols-outlined">arrow_forward</span>
    </button>
  </div>

  <!-- Trust Signals -->
  <div class="grid grid-cols-3 gap-2">
    <div class="bg-[#1a2e22]/50 rounded-2xl p-3 flex flex-col items-center justify-center text-center gap-1 border border-[#28392f]">
      <span class="material-symbols-outlined text-primary text-2xl">lock</span>
      <span class="text-[10px] uppercase font-bold text-[#9db9a8] tracking-wider">Paiement<br/>Sécurisé</span>
    </div>
    <div class="bg-[#1a2e22]/50 rounded-2xl p-3 flex flex-col items-center justify-center text-center gap-1 border border-[#28392f]">
      <span class="material-symbols-outlined text-primary text-2xl">local_shipping</span>
      <span class="text-[10px] uppercase font-bold text-[#9db9a8] tracking-wider">Livraison<br/>Rapide</span>
    </div>
    <div class="bg-[#1a2e22]/50 rounded-2xl p-3 flex flex-col items-center justify-center text-center gap-1 border border-[#28392f]">
      <span class="material-symbols-outlined text-primary text-2xl">support_agent</span>
      <span class="text-[10px] uppercase font-bold text-[#9db9a8] tracking-wider">Support<br/>24/7</span>
    </div>
  </div>
</div>
