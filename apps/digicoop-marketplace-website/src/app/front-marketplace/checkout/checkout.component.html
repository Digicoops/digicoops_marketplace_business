    <div class="w-full max-w-[1440px] mx-auto p-4 md:p-8 lg:p-12 xl:px-20 grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-16">
      
      <!-- Left Column (or Full Width for Step 3) -->
      <div [class.lg:col-span-7]="currentStep() < 3" 
           [class.xl:col-span-8]="currentStep() < 3" 
           [class.lg:col-span-12]="currentStep() === 3" 
           class="flex flex-col gap-8 transition-all duration-500">
        <!-- Breadcrumbs & Stepper -->
        <app-checkout-stepper [currentStep]="currentStep()" *ngIf="currentStep() < 3"></app-checkout-stepper>

        <div class="mb-4" *ngIf="currentStep() > 1 && currentStep() < 3">
           <button (click)="goToPrevStep()" class="flex items-center gap-2 text-sm font-medium text-[#9db9a8] hover:text-primary transition-colors">
            <span class="material-symbols-outlined text-base">arrow_back</span>
            Retour
          </button>
        </div>

        <div>
           <!-- Step 1 Content -->
           <div *ngIf="currentStep() === 1" class="animate-in fade-in slide-in-from-left-4 duration-500">
              <div>
                <h1 class="text-3xl md:text-4xl font-black text-white tracking-tight mb-2">Informations de livraison</h1>
                <p class="text-[#9db9a8]">Veuillez remplir vos coordonnées pour l'expédition.</p>
              </div>

              <!-- Reusable Form Component -->
              <div class="mt-8">
                <app-checkout-form></app-checkout-form>
              </div>
           </div>

            <!-- Step 2 Content: Payment -->
           <div *ngIf="currentStep() === 2">
              <h1 class="text-3xl md:text-4xl font-black text-white tracking-tight mb-2">Paiement</h1>
              <p class="text-[#9db9a8]">Choisissez votre méthode de paiement sécurisée.</p>
              
              <div class="mt-8">
                <app-checkout-payment (methodChange)="setPaymentMethod($event)"></app-checkout-payment>
              </div>
           </div>
           
            <!-- Step 3 Content: Confirmation -->
           <div *ngIf="currentStep() === 3" class="animate-in fade-in zoom-in duration-500 w-full">
              <app-checkout-confirmation></app-checkout-confirmation>
           </div>
        </div>

      </div>

      <!-- Right Column -->
      <div class="lg:col-span-5 xl:col-span-4" *ngIf="currentStep() < 3">
        <!-- Reusable Order Summary Component -->
        <app-checkout-order-summary 
            [actionLabel]="currentStep() === 1 ? 'Continuer vers le paiement' : 'Payer Maintenant'"
            (action)="goToNextStep()">
        </app-checkout-order-summary>
      </div>
    </div>


    <!-- Payment Processing Modal -->
    <div *ngIf="isProcessingPayment()" class="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-sm animate-in fade-in duration-300">
        <div class="bg-[#1a2e22] border border-[#28392f] p-8 rounded-3xl shadow-2xl flex flex-col items-center gap-6 max-w-sm w-full relative overflow-hidden">
             <!-- Animated Gradient Border -->
            <div className="absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent animate-pulse pointer-events-none"></div>

            <div class="relative size-20">
                <svg class="animate-spin text-primary w-full h-full" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            
            <div class="text-center space-y-2 relative z-10">
                <h3 class="text-xl font-bold text-white">Transaction en cours</h3>
                <p class="text-[#9db9a8] text-sm">Veuillez patienter pendant que nous sécurisons votre paiement...</p>
            </div>
        </div>
    </div>
